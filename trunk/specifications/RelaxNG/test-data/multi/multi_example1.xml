<?xml version="1.0" encoding="UTF-8"?>
<?xml-model href="../../sbml.rng" type="application/xml" schematypens="http://relaxng.org/ns/structure/1.0"?>
<sbml xmlns="http://www.sbml.org/sbml/level3/version1/core" xmlns:multi="http://www.sbml.org/sbml/level3/version1/multi/version1" 
  level="3" version="1" multi:required="true">

  <model>
    <listOfCompartments>
      <compartment id="cell" constant="true" size="1" />
    </listOfCompartments>
    
    <!-- ***************************************************** -->
    <!-- We need to define two species types to be able to describe all the reactions.    -->
    <!-- There is not species type for the kinase, that is not used in selectors.         -->
    <!-- ***************************************************** -->
    
    <multi:listOfSpeciesTypes>
      <multi:speciesType multi:id="st_recept"
        multi:name="receptor"
        multi:bindingSite="true">
        <multi:listOfStateFeatures>
          <multi:stateFeature multi:id="Y" multi:name="tyrosine">
            <multi:listOfPossibleValues>
              <multi:possibleValue multi:id="P" multi:name="phosphorylated" />
              <multi:possibleValue multi:id="nonP" multi:name="nonphosphorylated" />
            </multi:listOfPossibleValues>
          </multi:stateFeature>
        </multi:listOfStateFeatures>
      </multi:speciesType>
      
      <multi:speciesType multi:id="st_lig" multi:name="ligand" multi:bindingSite="true" />
    </multi:listOfSpeciesTypes>
    
    <multi:listOfSelectors>
      <!-- ***************************************************** -->
      <!-- Description of receptor, unbound, unphosphorylated                               -->
      <!-- ***************************************************** -->
      <multi:selector multi:id="sel_freereceptor_nonP">
        
        <multi:listOfSpeciesTypeStates>
          <multi:speciesTypeState
            multi:id="sts_recept" 
            multi:speciesType="st_recept"
            multi:minOccur="1" multi:maxOccur="1" 
            multi:connex="true" multi:saturated="true">
            
            <multi:listOfStateFeatureInstances>
              <multi:stateFeatureInstance multi:id="sfi1" multi:stateFeature="Y">
                <multi:listOfStateFeatureValues>
                  <multi:stateFeatureValue multi:possibleValue="nonphosphorylated" />
                </multi:listOfStateFeatureValues>
              </multi:stateFeatureInstance>
            </multi:listOfStateFeatureInstances>
          </multi:speciesTypeState>
        </multi:listOfSpeciesTypeStates>
        
        <multi:listOfUnboundBindingSites>
          <multi:bindingSiteReference multi:speciesTypeState="sts_recept" />
        </multi:listOfUnboundBindingSites>
      </multi:selector>   
      <!-- ***************************************************** -->
      <!-- Description of receptor, unbound, phosphorylated                                 -->
      <!-- ***************************************************** -->
      <multi:selector multi:id="sel_freereceptor_P">
        <multi:listOfSpeciesTypeStates>
          <multi:speciesTypeState 
            multi:id="sts_recept" 
            multi:speciesType="st_recept"
            multi:minOccur="1" multi:maxOccur="1"
            multi:connex="true" multi:saturated="true">
            <multi:listOfStateFeatureInstances>
              <multi:stateFeatureInstance multi:stateFeature="Y" multi:id="sfi2">
                <multi:listOfStateFeatureValues>
                  <multi:stateFeatureValue multi:possibleValue="phosphorylated" />
                </multi:listOfStateFeatureValues>              
              </multi:stateFeatureInstance>
            </multi:listOfStateFeatureInstances>
          </multi:speciesTypeState>
        </multi:listOfSpeciesTypeStates>
        
        <multi:listOfUnboundBindingSites>
          <multi:bindingSiteReference multi:speciesTypeState="sts_recept" />
        </multi:listOfUnboundBindingSites>
      </multi:selector>
      <!-- ***************************************************** -->
      <!-- Description of ligand, unbound                                                   -->
      <!-- ***************************************************** -->
      <multi:selector multi:id="sel_freeligand">
        <multi:listOfSpeciesTypeStates>
          <multi:speciesTypeState 
            multi:id="sts_lig" 
            multi:speciesType="st_lig"
            multi:minOccur="1" multi:maxOccur="1"
            multi:connex="true" multi:saturated="true"/>
        </multi:listOfSpeciesTypeStates>
        
        <multi:listOfUnboundBindingSites>
          <multi:bindingSiteReference multi:speciesTypeState="sts_lig" />
        </multi:listOfUnboundBindingSites>
      </multi:selector>
      <!-- ***************************************************** -->
      <!-- Description of the ligand-receptor complex                                       -->
      <!-- ***************************************************** -->
      <multi:selector multi:id="sel_complex">
        <multi:listOfSpeciesTypeStates>
          <multi:speciesTypeState 
            multi:id="sts_recept" 
            multi:speciesType="st_recept"
            multi:minOccur="1" multi:maxOccur="1" 
            multi:connex="true" multi:saturated="true"/>
          
          <multi:speciesTypeState 
            multi:id="sts_lig" 
            multi:speciesType="st_lig"
            multi:minOccur="1" multi:maxOccur="1"
            multi:connex="true" multi:saturated="true"/>
        </multi:listOfSpeciesTypeStates>
        
        <multi:listOfBonds>
          <multi:bond multi:occurrence="required">
            <multi:bindingSiteReference multi:speciesTypeState="sts_lig" />
            <multi:bindingSiteReference multi:speciesTypeState="sts_recept" />
          </multi:bond>
        </multi:listOfBonds>
      </multi:selector>
    </multi:listOfSelectors>
    
    <listOfSpecies>
      <species id="kinase" 
        compartment="cell" boundaryCondition="false"
        hasOnlySubstanceUnits="false" constant="false" 
        initialAmount="100" />
      
      <species id="recept" 
        multi:speciesType="st_recept"
        compartment="cell" boundaryCondition="false" 
        hasOnlySubstanceUnits="false" constant="false" 
        initialAmount="100" >
        <multi:listOfSpeciesTypeInstances>
          <multi:speciesTypeInstance 
            multi:id="freereceptor_nonP"
            multi:initialAmount="100">
            <multi:listOfSelectorReferences>
              <multi:selectorReference multi:selector="sel_freereceptor_nonP"  multi:negation="false"/>
            </multi:listOfSelectorReferences>
            </multi:speciesTypeInstance>
            
            <multi:speciesTypeInstance 
              multi:id="freereceptor_P"
              multi:initialAmount="0">
              <multi:listOfSelectorReferences>
                <multi:selectorReference multi:selector="sel_freereceptor_P"  multi:negation="false"/>
              </multi:listOfSelectorReferences>
              </multi:speciesTypeInstance>
              
              <multi:speciesTypeInstance multi:id="boundreceptor">
                <multi:listOfSelectorReferences>
                  <multi:selectorReference multi:selector="sel_complex" multi:negation="false"/>
                </multi:listOfSelectorReferences>
                </multi:speciesTypeInstance>
        </multi:listOfSpeciesTypeInstances>
      </species>
      
      <species id="lig" 
        multi:speciesType="st_lig"
        compartment="cell" boundaryCondition="false"
        hasOnlySubstanceUnits="false" constant="false" 
        initialAmount="1000" >
        <multi:listOfSpeciesTypeInstances>
          <multi:speciesTypeInstance multi:id="freeligand" multi:initialAmount="1000">
            <multi:listOfSelectorReferences>
              <multi:selectorReference multi:selector="sel_freeligand"  multi:negation="false"/>
            </multi:listOfSelectorReferences>
            </multi:speciesTypeInstance>
            
            <multi:speciesTypeInstance multi:id="boundligand" multi:initialAmount="0">
              <multi:listOfSelectorReferences>
                <multi:selectorReference multi:selector="sel_complex" multi:negation="false"/>
              </multi:listOfSelectorReferences>
              </multi:speciesTypeInstance>
        </multi:listOfSpeciesTypeInstances>
      </species>
    </listOfSpecies>
   
   <listOfInitialAssignments>
     <initialAssignment symbol="lig">
       <multi:speciesTypeInstanceChange multi:speciesTypeInstance="speciesTypeInstance1">
         <math xmlns="http://www.w3.org/1998/Math/MathML">
           <apply>
             <times/>
             <ci> x </ci>
             <ci> y </ci>
           </apply>
         </math>
       </multi:speciesTypeInstanceChange>
       <math xmlns="http://www.w3.org/1998/Math/MathML">
         <cn> 1000</cn>
       </math>
     </initialAssignment>
   </listOfInitialAssignments>
    <listOfReactions>
      <!-- ***************************************************** -->
      <!-- Phosphorylation of the receptor by the kinase when unbound                       -->
      <!-- ***************************************************** -->
      <reaction id="phosphorylation" reversible="false" fast="false">
        <listOfReactants>
          <speciesReference species="recept" stoichiometry="1" constant="true">
            <multi:listOfSpeciesTypeRestrictions>
              <multi:speciesTypeRestriction 
                multi:id="freeRnonP"
                multi:speciesTypeInstance="freereceptor_nonP" />
            </multi:listOfSpeciesTypeRestrictions>
          </speciesReference>
        </listOfReactants>
        
        <listOfProducts>
          <speciesReference species="recept" stoichiometry="1" constant="true" multi:correspondingReactant="recept">
            <multi:listOfSpeciesTypeRestrictions>
              <multi:speciesTypeRestriction 
                multi:id="freeRP"
                multi:speciesTypeInstance="freereceptor_P" />
            </multi:listOfSpeciesTypeRestrictions>
          </speciesReference>
        </listOfProducts>
        
        <listOfModifiers>
          <modifierSpeciesReference species="kinase" />
        </listOfModifiers>
        
        <kineticLaw>
          <math xmlns="http://www.w3.org/1998/Math/MathML">
          <cn>0</cn>
            </math>
        </kineticLaw>
        
        <multi:listOfReactionRules>
          <multi:reactionRule multi:id="PhosphorylationUnbound">
            <multi:listOfConditions>
              <multi:speciesTypeRestrictionReference 
                multi:speciesTypeRestriction="freeRnonP"/>
            </multi:listOfConditions>
            
            <multi:listOfResults>
              <multi:speciesTypeRestrictionReference multi:speciesTypeRestriction="freeRP"/>
            </multi:listOfResults>
            
            <kineticLaw>
              <math xmlns="http://www.w3.org/1998/Math/MathML" >
                <apply>
                  <times />
                  <ci> cell </ci>
                  <ci> Vm </ci>
                  <apply>
                    <divide />
                    <ci> recept </ci>
                    <apply>
                      <plus />
                      <ci> recept </ci>
                      <ci> Km </ci>
                    </apply>
                  </apply>
                </apply>
              </math>
              
              <listOfLocalParameters>
                <localParameter id="Km" value="1" />
                <localParameter id="Vm" value="1" />
              </listOfLocalParameters>
            </kineticLaw>
          </multi:reactionRule>
        </multi:listOfReactionRules>
      </reaction>
      <!-- ***************************************************** -->
      <!-- Ligand binding, when the receptor is phosphorylated or not                       -->
      <!-- ***************************************************** -->
      <reaction id="receptLigBinding" reversible="false" fast="false">
        <listOfReactants>
          <speciesReference id="react_recept" 
            species="recept" 
            stoichiometry="1" constant="true">
            <multi:listOfSpeciesTypeRestrictions>
              <multi:speciesTypeRestriction 
                multi:id="freeRnonP"
                multi:speciesTypeInstance="freereceptor_nonP" />
              
              <multi:speciesTypeRestriction 
                multi:id="freeRP"
                multi:speciesTypeInstance="freereceptor_P" />
            </multi:listOfSpeciesTypeRestrictions>
          </speciesReference>
          
          <speciesReference id="react_lig" 
            species="lig" 
            stoichiometry="1" constant="true">
            <multi:listOfSpeciesTypeRestrictions>
              <multi:speciesTypeRestriction 
                multi:id="freeL"
                multi:speciesTypeInstance="freeligand" />
            </multi:listOfSpeciesTypeRestrictions>
          </speciesReference>
        </listOfReactants>
        
        <listOfProducts>
          <speciesReference 
            species="recept" stoichiometry="1"
            multi:correspondingReactant="react_recept"
            constant="true">
            <multi:listOfSpeciesTypeRestrictions>
              <multi:speciesTypeRestriction 
                multi:id="boundR"
                multi:speciesTypeInstance="boundreceptor" />
            </multi:listOfSpeciesTypeRestrictions>
          </speciesReference>
          
          <speciesReference 
            species="lig" stoichiometry="1"
            multi:correspondingReactant="react_lig"
            constant="true">
            <multi:listOfSpeciesTypeRestrictions>
              <multi:speciesTypeRestriction 
                multi:id="boundL"
                multi:speciesTypeInstance="boundligand" />
            </multi:listOfSpeciesTypeRestrictions>
          </speciesReference>
        </listOfProducts>
        
        <kineticLaw>
          <math xmlns="http://www.w3.org/1998/Math/MathML">
            <cn>0</cn>
          </math>
        </kineticLaw>
        
        <multi:listOfReactionRules>
          <multi:reactionRule multi:id="bindingNonPhospho">
            <multi:listOfConditions>
              <multi:speciesTypeRestrictionReference 
                multi:speciesTypeRestriction="freeRnonP" />
              
              <multi:speciesTypeRestrictionReference 
                multi:speciesTypeRestriction="freeL" />
            </multi:listOfConditions>
            
            <multi:listOfResults>
              <multi:speciesTypeRestrictionReference 
                multi:speciesTypeRestriction="boundR" />
              
              <multi:speciesTypeRestrictionReference 
                multi:speciesTypeRestriction="boundL" />
            </multi:listOfResults>
            
            <kineticLaw>
              <math xmlns="http://www.w3.org/1998/Math/MathML" >
                <apply>
                  <times />
                  <ci> cell </ci>
                  <ci> kon_nonphos </ci>
                  <ci> recept </ci>
                  <ci> lig </ci>
                </apply>
              </math>
              
              <listOfLocalParameters>
                <localParameter id="kon_nonphos" value="1"/>
              </listOfLocalParameters>
            </kineticLaw>
          </multi:reactionRule>
          
          <multi:reactionRule multi:id="bindingPhospho">
            <multi:listOfConditions>
              <multi:speciesTypeRestrictionReference 
                multi:speciesTypeRestriction="freeRP" />
              
              <multi:speciesTypeRestrictionReference 
                multi:speciesTypeRestriction="freeL" />
            </multi:listOfConditions>
            
            <multi:listOfResults>
              <multi:speciesTypeRestrictionReference 
                multi:speciesTypeRestriction="boundR" />
              
              <multi:speciesTypeRestrictionReference 
                multi:speciesTypeRestriction="boundL" />
            </multi:listOfResults>
            
            <kineticLaw>
              <math xmlns="http://www.w3.org/1998/Math/MathML" >
                <apply>
                  <times />
                  <ci> cell </ci>
                  <ci> kon_phos </ci>
                  <ci> recept </ci>
                  <ci> lig </ci>
                </apply>
              </math>
              
              <listOfLocalParameters>
                <localParameter id="kon_phos" value="10"/>
              </listOfLocalParameters>
            </kineticLaw>
          </multi:reactionRule>
        </multi:listOfReactionRules>
      </reaction>
    </listOfReactions>
  </model>
  
      
</sbml>
